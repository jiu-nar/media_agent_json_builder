<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Intent & Named Entity JSON Builder</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    .section { margin-bottom: 2rem; }
    .entity-group { margin-bottom: 1rem; }
    .entity-strings { margin-left: 1rem; }
    textarea { width: 100%; height: 100px; }
    button { margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Intent & Named Entity JSON Builder</h1>

  <div class="section">
    <h2>1. Intent 선택 (1개)</h2>
    <div id="intent-buttons"></div>
  </div>

  <div class="section">
    <h2>2. Named Entity 선택 및 값 입력</h2>
    <div id="entity-checkboxes"></div>
  </div>

  <div class="section">
    <h2>3. 결과 JSON</h2>
    <textarea id="result-json" readonly></textarea><br>
    <button onclick="copyResult()">JSON 복사</button>
  </div>

  <script>
    // 데이터
    const intent_buttons = [
      "search_contents", "search_contents_info", "ranking_chart", "recommend_theme",
      "recommend_similar", "btv_functions", "new_contents", "search_youtube",
      "close_agent", "box_office_contents", "search_channel", "select_contents_number",
      "not_support", "modify_search", "play_music", "search_sports", "set_channel",
      "popular_channel", "sort_recent", "sort_popular", "sort_star_rate", "other_contents",
      "upcoming_release", "free_talk", "search_review", "change_profile",
      "recommend_prefer_vod", "recommend_freq_vod", "recommend_prefer_channel", 
      "my_watch_vod", "my_rent_vod", "my_own_vod", "my_like_vod", "my_like_channel", "my_reserve_channel"
    ];

    const named_entity_buttons = [
      "title", "program", "genre", "content_type", "channel", "people_name", "people_role",
      "theme", "country", "OTT_name", "season_order", "episode_order", "time_expression",
      "day_of_week", "sort_type", "sports_type", "sports_team", "sports_league",
      "age_rating", "awards", "price", "attendance", "select_number", "running_time",
      "btv_function_name", "keyword", "star_rate", "youtube_search_query", "is_concluded",
      "is_original", "theater_showing"
    ];

    // DOM 요소
    const intentDiv = document.getElementById('intent-buttons');
    const entityDiv = document.getElementById('entity-checkboxes');
    const resultTextArea = document.getElementById('result-json');

    // Intent 라디오 버튼 생성
    intent_buttons.forEach(intent => {
      const label = document.createElement('label');
      label.style.marginRight = "1em";
      const radio = document.createElement('input');
      radio.type = 'radio';
      radio.name = 'intent';
      radio.value = intent;
      radio.onchange = updateResult;
      label.appendChild(radio);
      label.appendChild(document.createTextNode(intent));
      intentDiv.appendChild(label);
    });

    // Named entity 체크박스 및 string list 입력 UI 생성
    named_entity_buttons.forEach(entity => {
      const group = document.createElement('div');
      group.className = 'entity-group';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.value = entity;
      checkbox.id = `cb-${entity}`;
      checkbox.onchange = function() {
        entityStringsDiv.style.display = this.checked ? '' : 'none';
        updateResult();
      };

      const label = document.createElement('label');
      label.htmlFor = checkbox.id;
      label.appendChild(document.createTextNode(entity));

      const entityStringsDiv = document.createElement('div');
      entityStringsDiv.className = 'entity-strings';
      entityStringsDiv.style.display = 'none';

      const addBtn = document.createElement('button');
      addBtn.type = 'button';
      addBtn.textContent = '+ 값 추가';
      addBtn.onclick = function() {
        addStringInput(entityStringsDiv, entity);
      };

      entityStringsDiv.appendChild(addBtn);

      group.appendChild(checkbox);
      group.appendChild(label);
      group.appendChild(entityStringsDiv);

      entityDiv.appendChild(group);
    });

    // string input 추가 함수
    function addStringInput(parent, entity) {
      const container = document.createElement('div');
      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = `${entity} 값`;
      input.oninput = updateResult;

      const removeBtn = document.createElement('button');
      removeBtn.type = 'button';
      removeBtn.textContent = '삭제';
      removeBtn.onclick = function() {
        parent.removeChild(container);
        updateResult();
      };

      container.appendChild(input);
      container.appendChild(removeBtn);
      parent.insertBefore(container, parent.lastChild);
    }

    // 결과 JSON 업데이트 함수
    function updateResult() {
      // Intent 선택값
      const intent = document.querySelector('input[name="intent"]:checked');
      const result = {};

      if (intent) result.intent = intent.value;

      // Named entity
      const entities = {};
      named_entity_buttons.forEach(entity => {
        const cb = document.getElementById(`cb-${entity}`);
        if (cb && cb.checked) {
          // 해당 entity의 입력된 값들 수집
          const inputDiv = cb.parentNode.querySelector('.entity-strings');
          const values = [];
          if (inputDiv) {
            const inputs = inputDiv.querySelectorAll('input[type="text"]');
            inputs.forEach(inp => {
              if (inp.value.trim()) values.push(inp.value.trim());
            });
          }
          if (values.length > 0) {
            entities[entity] = values;
          }
        }
      });

      if (Object.keys(entities).length > 0) {
        result.named_entity = entities;
      }

      resultTextArea.value = Object.keys(result).length ? JSON.stringify(result, null, 2) : '';
    }

    // 복사 기능
    function copyResult() {
      resultTextArea.select();
      document.execCommand('copy');
      alert('JSON이 복사되었습니다!');
    }
  </script>
</body>
</html>